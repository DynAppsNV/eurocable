<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <template
        id="report_report_picking_inherit_stock"
        inherit_id="stock.report_picking"
        priority="99"
    >
        <xpath
            expr="//div[@name='div_outgoing_address']//div[@t-field='o.move_ids[0].partner_id']"
            position="attributes"
        >
            <attribute name="t-options">
                {"widget": "contact", "fields": ["address", "name"], "no_marker": True}
            </attribute>
        </xpath>
        <xpath
            expr="//div[@name='div_outgoing_address']//div[@t-field='o.picking_type_id.warehouse_id.partner_id']"
            position="attributes"
        >
            <attribute name="t-options">
                {"widget": "contact", "fields": ["address", "name"], "no_marker": True}
            </attribute>
        </xpath>
        <xpath expr="//div[@name='partner_header']/div" position="attributes">
            <attribute name="t-options">
                {"widget": "contact", "fields": ["address", "name", "vat"], "no_marker": True}
            </attribute>
        </xpath>
        <xpath expr="//div[div[@name='div_outgoing_address']]" position="after">
            <div class="row mt-4">
                <div class="col-6" />
                <div class="col-5 offset-1" name="xx_document_title" />
            </div>
        </xpath>
        <div name="xx_document_title" position="inside">
            <h1 position="move" />
        </div>
        <div name="div_origin" position="before">
            <div t-if="o.sale_id.client_order_ref" class="col-auto" name="div_cust_ref">
                <strong>Your reference:</strong>
                <p t-field="o.sale_id.client_order_ref" />
            </div>
        </div>
        <div name="div_sched_date" position="after">
            <div t-if="o.date_done" class="col-auto" name="div_date_done">
                <strong>Delivery Date:</strong>
                <p t-field="o.date_done" t-options="{'widget': 'date'}" />
            </div>
            <div t-if="o.user_id" class="col-auto" name="div_contact">
                <strong>Contact Person:</strong>
                <p t-field="o.user_id" />
            </div>
            <div t-if="o.sale_id.incoterm" class="col-auto" name="div_incoterm">
                <strong>Incoterm:</strong>
                <p t-field="o.sale_id.incoterm" />
            </div>
            <t
                t-set="total_weight"
                t-value="sum(ml.move_id.total_weight for ml in o.move_line_ids_without_package)"
            />
            <div t-if="total_weight" class="col-auto" name="div_total_weight">
                <strong>Total Weight:</strong>
                <p>
                    <span t-out="total_weight" />
                    <span t-out="o.weight_uom_name" />
                </p>
            </div>
        </div>
        <div name="div_state" position="replace" />
        <xpath expr="//div[@name='div_sched_date']/p" position="attributes">
            <attribute name="t-options">{"widget": "date"}</attribute>
        </xpath>
        <xpath expr="//div[p[@t-field='o.carrier_id']]" position="replace" />
        <xpath expr="//div[span[@t-field='o.weight']]" position="replace" />
        <xpath expr="//th[@name='th_product']/strong" position="replace">
            <strong>Description</strong>
        </xpath>
        <th name="th_product" position="after">
            <th name="th_serial_number" position="move" />
        </th>
        <th name="th_from" position="replace" />
        <th name="th_to" position="replace" />
        <th name="th_barcode" position="replace" />
        <xpath expr="//tr[th[@name='th_product']]" position="inside">
            <th name="th_total_weight" class="text-center">
                <strong>Product Total Weight</strong>
            </th>
        </xpath>
        <xpath expr="//td[span[@t-field='ml.product_id.display_name']]" position="after">
            <td t-if="has_serial_number" position="move" />
        </xpath>
        <xpath expr="//td[t[span[@t-field='ml.package_id']]]" position="replace" />
        <td t-if="has_barcode" position="replace" />
        <xpath expr="//tr[td[span[@t-field='ml.product_id.display_name']]]" position="inside">
            <td class="text-center">
                <span t-field="ml.move_id.total_weight" />
                <span t-field="ml.product_id.weight_uom_name" />
            </td>
        </xpath>
    </template>
</odoo>
